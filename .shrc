#!/bin/sh

# Remove path from PATH
remove_path() {
  new_path="$(echo "$PATH" | sed -e "s@:$1@@g" -e "s@$1:@@g" -e "s@$1@@g")"
  export PATH="$new_path"
}

# Add path to the start of PATH
prepend_path() {
  [ -d "$1" ] || return 1
  remove_path "$1"
  export PATH="$1:${PATH}"
}

# Add path to the end of PATH
append_path() {
  [ -d "$1" ] || return 1
  remove_path "$1"
  export PATH="${PATH}:$1"
}

# Check if a command exists
command_exists() {
  command -v "$1" >/dev/null 2>&1
}

# Homebrew

if command_exists brew; then
  export HOMEBREW_AUTOREMOVE=1
  export HOMEBREW_BOOTSNAP=1
  export HOMEBREW_CLEANUP_MAX_AGE_DAYS=30
  export HOMEBREW_CLEANUP_PERIODIC_FULL_DAYS=1
  # Enable Homebrew developer mode
  export HOMEBREW_DEVELOPER=1
  # Disable 'anonymous' analytics
  export HOMEBREW_NO_ANALYTICS=1
  # Remove previously installed versions of insalled/upgraded formulae
  export HOMEBREW_INSTALL_CLEANUP=1
  # Do not permit redirects from HTTPS to HTTP
  export HOMEBREW_NO_INSECURE_REDIRECT=1
  # Do not show environment variable hints
  export HOMEBREW_NO_ENV_HINTS=1
  export HOMEBREW_SORBET_RUNTIME=1

  eval "$(brew shellenv)"
fi
